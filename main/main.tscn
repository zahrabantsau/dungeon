[gd_scene load_steps=13 format=3 uid="uid://dgg8l7aubm371"]

[ext_resource type="PackedScene" uid="uid://ct6f0lqmv6r5" path="res://level/dungeon.tscn" id="1_bidkp"]
[ext_resource type="Script" path="res://main/main.gd" id="1_m01bs"]
[ext_resource type="Texture2D" uid="uid://dlfybpnx4bgqp" path="res://assets/dungeon/Samples/dungeon_remastered_sample1.png" id="2_da848"]
[ext_resource type="PackedScene" uid="uid://jnreadvmkix" path="res://player/knight.tscn" id="2_va6rj"]
[ext_resource type="Script" path="res://main/spawn_point.gd" id="5_cpwk4"]
[ext_resource type="PackedScene" uid="uid://r5ixq2gn1g7q" path="res://level/portal.tscn" id="6_fj7u7"]
[ext_resource type="Texture2D" uid="uid://daxgjos8v8d2i" path="res://assets/win_image.png" id="7_rjwll"]

[sub_resource type="Theme" id="Theme_vc2yo"]
default_font_size = 44

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_e5qri"]
sun_angle_max = 43.33
sun_curve = 0.270375

[sub_resource type="Sky" id="Sky_j6xad"]
sky_material = SubResource("ProceduralSkyMaterial_e5qri")

[sub_resource type="Environment" id="Environment_jq3ql"]
background_mode = 2
sky = SubResource("Sky_j6xad")

[sub_resource type="NavigationMesh" id="NavigationMesh_24vrx"]
vertices = PackedVector3Array(-26.3797, 4.42251, -3.1297, -26.3797, 4.42251, -2.8797, -26.1297, 4.42251, -2.3797, -25.6297, 4.42251, -2.8797, -25.6297, 4.42251, -3.1297, -25.8797, 4.42251, -9.6297, -21.3797, 4.42251, -1.1297, -21.1297, 4.42251, -1.6297, -21.3797, 4.42251, -3.1297, -21.8797, 4.42251, -2.8797, -25.8797, 4.42251, -9.6297, -25.8797, 4.42251, -10.1297, -26.3797, 4.42251, -3.1297, -42.1297, 4.42251, -3.1297, -42.6297, 4.42251, -2.8797, -26.3797, 4.42251, -2.8797, -26.3797, 4.42251, -3.1297, -14.1297, 4.42251, -1.8797, -21.1297, 4.42251, -1.6297, -21.3797, 4.42251, -1.1297, -10.3797, 4.42251, -1.6297, -13.8797, 4.42251, -1.8797, -2.6297, 4.42251, -13.8797, -10.1297, 4.42251, -13.3797, -9.8797, 4.42251, -13.1297, -2.6297, 4.42251, -13.1297, 17.3703, 4.42251, 17.1203, 17.6203, 4.42251, 17.6203, 17.6203, 4.42251, -1.6297, 17.1203, 4.42251, -1.3797, -25.8797, 4.42251, -10.1297, -25.8797, 4.42251, -9.6297, -14.3797, 4.42251, -9.8797, -13.8797, 4.42251, -10.1297, -2.3797, 4.42251, -42.6297, -2.8797, 4.42251, -42.3797, -2.6297, 4.42251, -13.8797, -2.3797, 4.42251, -1.8797, -13.8797, 4.42251, -1.8797, -13.8797, 4.42251, -10.1297, -14.3797, 4.42251, -9.8797, -14.1297, 4.42251, -1.8797, -2.6297, 4.42251, -13.1297, -2.6297, 4.42251, -1.8797, -2.3797, 4.42251, -1.8797, -21.8797, 4.42251, -2.8797, -21.3797, 4.42251, -3.1297, -25.6297, 4.42251, -3.1297, -25.6297, 4.42251, -2.8797, -21.3797, 4.42251, -1.1297, -21.8797, 4.42251, -2.8797, -21.6297, 4.42251, 17.6203, -21.1297, 4.42251, 17.3703, -9.8797, 4.42251, -1.8797, -9.8797, 4.42251, -13.1297, -10.1297, 4.42251, -13.3797, -10.3797, 4.42251, -1.6297, -21.1297, 4.42251, 17.3703, -21.6297, 4.42251, 17.6203, 17.6203, 4.42251, 17.6203, 17.3703, 4.42251, 17.1203, -2.6297, 4.42251, -1.8797, -9.8797, 4.42251, -1.8797, -10.3797, 4.42251, -1.6297, -2.6297, 4.42251, -1.8797, -10.3797, 4.42251, -1.6297, -21.3797, 4.42251, -1.1297, 17.1203, 4.42251, -1.3797, 17.6203, 4.42251, -1.6297, -2.3797, 4.42251, -1.8797, -2.6297, 4.42251, -13.8797, -2.6297, 4.42251, -13.1297, -2.3797, 4.42251, -1.8797, -42.3797, 4.42251, -42.1297, -42.6297, 4.42251, -42.6297, -42.6297, 4.42251, -2.8797, -42.1297, 4.42251, -3.1297, -42.6297, 4.42251, -42.6297, -42.3797, 4.42251, -42.1297, -2.8797, 4.42251, -42.3797, -2.3797, 4.42251, -42.6297, -9.3797, 0.422506, -41.1297, -10.3797, 0.672506, -41.6297, -10.6297, 0.422506, -41.1297, -7.3797, 0.422506, -14.8797, -13.3797, 0.422506, -41.1297, -14.3797, 0.672506, -41.6297, -14.6297, 0.422506, -41.1297, -10.6297, 0.422506, -14.3797, -17.3797, 0.422506, -41.1297, -18.3797, 0.672506, -41.6297, -18.6297, 0.422506, -41.1297, -10.6297, 0.422506, -14.3797, -21.3797, 0.422506, -41.1297, -22.3797, 0.672506, -41.6297, -22.6297, 0.422506, -41.1297, -10.6297, 0.422506, -14.3797, -25.3797, 0.422506, -41.1297, -26.3797, 0.672506, -41.6297, -26.6297, 0.422506, -41.1297, -25.6297, 0.422506, -11.1297, -29.3797, 0.422506, -41.1297, -30.3797, 0.672506, -41.6297, -30.6297, 0.422506, -41.1297, -26.6297, 0.422506, -10.8797, -25.6297, 0.422506, -11.1297, -33.3797, 0.422506, -41.1297, -34.3797, 0.672506, -41.6297, -34.6297, 0.422506, -41.1297, -26.6297, 0.422506, -10.8797, -37.3797, 0.422506, -41.1297, -38.3797, 0.672506, -41.6297, -38.6297, 0.422506, -41.1297, -26.6297, 0.422506, -10.8797, -41.1297, 0.422506, -3.8797, -39.6297, 0.422506, -3.8797, -38.8797, 0.422506, -4.3797, -3.8797, 0.422506, -41.1297, -6.3797, 0.672506, -41.6297, -6.6297, 0.422506, -41.1297, -7.3797, 0.422506, -14.8797, -4.6297, 0.422506, -14.8797, -13.1297, 0.422506, -10.6297, -12.8797, 0.422506, -8.6297, -11.1297, 0.422506, -8.6297, -11.1297, 0.422506, -13.3797, -10.6297, 0.422506, -14.3797, -8.1297, 0.422506, -14.3797, -7.3797, 0.422506, -14.8797, -10.6297, 0.422506, -41.1297, -13.3797, 0.422506, -41.1297, -10.6297, 0.422506, -14.3797, -14.6297, 0.422506, -41.1297, -17.3797, 0.422506, -41.1297, -14.1297, 0.422506, -11.1297, -13.1297, 0.422506, -10.6297, -11.1297, 0.422506, -13.3797, -14.1297, 0.422506, -11.1297, -11.1297, 0.422506, -13.3797, -10.6297, 0.422506, -14.3797, -22.6297, 0.422506, -41.1297, -25.3797, 0.422506, -41.1297, -25.6297, 0.422506, -11.1297, -38.8797, 0.422506, -4.3797, -27.1297, 0.422506, -4.1297, -27.1297, 0.422506, -9.8797, -38.8797, 0.422506, -4.3797, -27.1297, 0.422506, -9.8797, -26.6297, 0.422506, -10.8797, -38.6297, 0.422506, -41.1297, -41.1297, 0.422506, -41.1297, -41.1297, 0.422506, -3.8797, -25.6297, 0.422506, -11.1297, -26.6297, 0.422506, -41.1297, -29.3797, 0.422506, -41.1297, -26.6297, 0.422506, -10.8797, -34.6297, 0.422506, -41.1297, -37.3797, 0.422506, -41.1297, -4.6297, 0.422506, -14.8797, -3.6297, 0.422506, -14.3797, -3.8797, 0.422506, -41.1297, -26.6297, 0.422506, -10.8797, -30.6297, 0.422506, -41.1297, -33.3797, 0.422506, -41.1297, -10.6297, 0.422506, -14.3797, -18.6297, 0.422506, -41.1297, -21.3797, 0.422506, -41.1297, -7.3797, 0.422506, -14.8797, -6.6297, 0.422506, -41.1297, -9.3797, 0.422506, -41.1297, -3.8797, 0.422506, -12.6297, -9.1297, 0.422506, -12.6297, -8.6297, 0.422506, -10.8797, -8.6297, 0.422506, -4.1297, -9.1297, 0.422506, -2.3797, -3.6297, 0.422506, -2.3797, -8.6297, 0.422506, -4.1297, -3.6297, 0.422506, -2.3797, -3.8797, 0.422506, -12.6297, -8.6297, 0.422506, -10.8797, -19.3797, 0.422506, -8.6297, -20.3797, 0.672506, -9.1297, -20.6297, 0.422506, -8.6297, -20.8797, 0.422506, -3.8797, -14.8797, 0.422506, -9.1297, -16.3797, 0.672506, -9.1297, -16.6297, 0.422506, -8.6297, -23.3797, 0.422506, -8.6297, -25.1297, 0.422506, -9.1297, -24.8797, 0.422506, -4.3797, -23.3797, 0.422506, -8.6297, -24.8797, 0.422506, -4.3797, -20.8797, 0.422506, -3.8797, -20.6297, 0.422506, -8.6297, -16.6297, 0.422506, -8.6297, -19.3797, 0.422506, -8.6297, -20.8797, 0.422506, -3.8797, -20.8797, 0.422506, -3.8797, -20.3797, 0.422506, -2.3797, -14.8797, 0.422506, -2.3797, -14.8797, 0.422506, -9.1297, -16.6297, 0.422506, -8.6297, 12.1203, 0.422506, -0.129696, 11.3703, 0.672506, -0.629696, 10.8703, 0.422506, -0.129696, 16.1203, 0.422506, 2.6203, 8.1203, 0.422506, -0.129696, 7.1203, 0.672506, -0.629696, 6.8703, 0.422506, -0.129696, 4.1203, 0.422506, -0.129696, 3.1203, 0.672506, -0.629696, 2.8703, 0.422506, -0.129696, 16.6203, 0.422506, -0.629696, 15.1203, 0.672506, -0.629696, 14.8703, 0.422506, -0.129696, 16.6203, 0.422506, 1.8703, -13.1297, 0.422506, -3.8797, -13.1297, 0.422506, -2.3797, -12.3797, 0.422506, -2.1297, -12.6297, 0.422506, -4.6297, 16.1203, 0.422506, 2.6203, 8.1203, 0.422506, -0.129696, 6.8703, 0.422506, -0.129696, 16.1203, 0.422506, 2.6203, 2.8703, 0.422506, -0.129696, 0.120304, 0.422506, -0.129696, 16.6203, 0.422506, 16.1203, 16.6203, 0.422506, 14.1203, 16.1203, 0.422506, 13.3703, -4.6297, 0.422506, -0.129696, -7.3797, 0.422506, -0.129696, -20.3797, 0.422506, 16.1203, 16.1203, 0.422506, 2.6203, 16.6203, 0.422506, 1.8703, 14.8703, 0.422506, -0.129696, 12.1203, 0.422506, -0.129696, -0.629696, 0.422506, -0.629696, -4.3797, 0.672506, -0.629696, -4.6297, 0.422506, -0.129696, 0.120304, 0.422506, -0.129696, -7.3797, 0.422506, -0.129696, -8.1297, 0.422506, -0.629696, -11.3797, 0.422506, -0.629696, -16.6297, 0.422506, -0.129696, -19.8797, 0.422506, 13.6203, -20.3797, 0.422506, 16.1203, -10.8797, 0.422506, -2.3797, -11.1297, 0.422506, -8.6297, -12.8797, 0.422506, -8.6297, -12.6297, 0.422506, -4.6297, -12.3797, 0.422506, -2.1297, -11.6297, 0.422506, -2.1297, 16.1203, 0.422506, 2.6203, 6.8703, 0.422506, -0.129696, 4.1203, 0.422506, -0.129696, 16.1203, 0.422506, 2.6203, 4.1203, 0.422506, -0.129696, 2.8703, 0.422506, -0.129696, 16.1203, 0.422506, 2.6203, 10.8703, 0.422506, -0.129696, 8.1203, 0.422506, -0.129696, -11.6297, 0.422506, -2.1297, -12.3797, 0.422506, -2.1297, -12.3797, 0.422506, -0.879696, -11.3797, 0.422506, -0.629696, -11.3797, 0.422506, -0.629696, -12.3797, 0.422506, -0.879696, -16.6297, 0.422506, -0.129696, 16.1203, 0.422506, 2.6203, 0.120304, 0.422506, -0.129696, -4.6297, 0.422506, -0.129696, 16.1203, 0.422506, 13.3703, -16.6297, 0.422506, -0.129696, -20.1297, 0.422506, -0.379696, -19.8797, 0.422506, 13.6203)
polygons = [PackedInt32Array(1, 0, 2), PackedInt32Array(2, 0, 3), PackedInt32Array(3, 0, 4), PackedInt32Array(4, 0, 5), PackedInt32Array(8, 7, 9), PackedInt32Array(9, 7, 6), PackedInt32Array(12, 11, 10), PackedInt32Array(16, 15, 13), PackedInt32Array(13, 15, 14), PackedInt32Array(21, 20, 17), PackedInt32Array(17, 20, 18), PackedInt32Array(18, 20, 19), PackedInt32Array(24, 23, 25), PackedInt32Array(25, 23, 22), PackedInt32Array(29, 28, 26), PackedInt32Array(26, 28, 27), PackedInt32Array(31, 30, 32), PackedInt32Array(32, 30, 33), PackedInt32Array(35, 34, 36), PackedInt32Array(36, 34, 37), PackedInt32Array(41, 40, 38), PackedInt32Array(38, 40, 39), PackedInt32Array(44, 43, 42), PackedInt32Array(48, 47, 45), PackedInt32Array(45, 47, 46), PackedInt32Array(52, 51, 49), PackedInt32Array(49, 51, 50), PackedInt32Array(54, 53, 55), PackedInt32Array(55, 53, 56), PackedInt32Array(60, 59, 57), PackedInt32Array(57, 59, 58), PackedInt32Array(63, 62, 61), PackedInt32Array(64, 69, 65), PackedInt32Array(65, 69, 66), PackedInt32Array(66, 69, 67), PackedInt32Array(67, 69, 68), PackedInt32Array(72, 71, 70), PackedInt32Array(76, 75, 73), PackedInt32Array(73, 75, 74), PackedInt32Array(78, 77, 79), PackedInt32Array(79, 77, 80), PackedInt32Array(82, 81, 83), PackedInt32Array(83, 81, 84), PackedInt32Array(86, 85, 87), PackedInt32Array(87, 85, 88), PackedInt32Array(90, 89, 91), PackedInt32Array(91, 89, 92), PackedInt32Array(94, 93, 95), PackedInt32Array(95, 93, 96), PackedInt32Array(98, 97, 99), PackedInt32Array(99, 97, 100), PackedInt32Array(102, 101, 103), PackedInt32Array(103, 101, 105), PackedInt32Array(103, 105, 104), PackedInt32Array(107, 106, 108), PackedInt32Array(108, 106, 109), PackedInt32Array(111, 110, 112), PackedInt32Array(112, 110, 113), PackedInt32Array(116, 115, 114), PackedInt32Array(118, 117, 119), PackedInt32Array(119, 117, 121), PackedInt32Array(119, 121, 120), PackedInt32Array(123, 122, 124), PackedInt32Array(124, 122, 125), PackedInt32Array(127, 126, 128), PackedInt32Array(128, 126, 129), PackedInt32Array(129, 126, 130), PackedInt32Array(133, 132, 131), PackedInt32Array(136, 135, 134), PackedInt32Array(138, 137, 139), PackedInt32Array(139, 137, 142), PackedInt32Array(139, 142, 140), PackedInt32Array(140, 142, 141), PackedInt32Array(145, 144, 143), PackedInt32Array(147, 146, 148), PackedInt32Array(148, 146, 151), PackedInt32Array(148, 151, 149), PackedInt32Array(149, 151, 150), PackedInt32Array(154, 153, 152), PackedInt32Array(157, 156, 155), PackedInt32Array(160, 159, 158), PackedInt32Array(163, 162, 161), PackedInt32Array(166, 165, 164), PackedInt32Array(169, 168, 167), PackedInt32Array(172, 171, 170), PackedInt32Array(175, 174, 173), PackedInt32Array(179, 178, 176), PackedInt32Array(176, 178, 177), PackedInt32Array(181, 180, 182), PackedInt32Array(182, 180, 183), PackedInt32Array(184, 186, 185), PackedInt32Array(189, 188, 187), PackedInt32Array(193, 192, 190), PackedInt32Array(190, 192, 191), PackedInt32Array(196, 195, 194), PackedInt32Array(198, 197, 199), PackedInt32Array(199, 197, 201), PackedInt32Array(199, 201, 200), PackedInt32Array(203, 202, 204), PackedInt32Array(204, 202, 205), PackedInt32Array(206, 208, 207), PackedInt32Array(209, 211, 210), PackedInt32Array(213, 212, 214), PackedInt32Array(214, 212, 215), PackedInt32Array(217, 216, 218), PackedInt32Array(218, 216, 219), PackedInt32Array(222, 221, 220), PackedInt32Array(225, 224, 223), PackedInt32Array(227, 226, 228), PackedInt32Array(228, 226, 229), PackedInt32Array(229, 226, 230), PackedInt32Array(230, 226, 231), PackedInt32Array(233, 232, 234), PackedInt32Array(234, 232, 235), PackedInt32Array(237, 236, 238), PackedInt32Array(238, 236, 239), PackedInt32Array(241, 240, 242), PackedInt32Array(242, 240, 243), PackedInt32Array(243, 240, 244), PackedInt32Array(244, 240, 245), PackedInt32Array(251, 250, 246), PackedInt32Array(246, 250, 249), PackedInt32Array(246, 249, 247), PackedInt32Array(247, 249, 248), PackedInt32Array(254, 253, 252), PackedInt32Array(257, 256, 255), PackedInt32Array(260, 259, 258), PackedInt32Array(262, 261, 263), PackedInt32Array(263, 261, 264), PackedInt32Array(267, 266, 265), PackedInt32Array(269, 268, 270), PackedInt32Array(270, 268, 271), PackedInt32Array(273, 272, 274)]

[node name="Main" type="Node3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.787014, 1.63388)
script = ExtResource("1_m01bs")

[node name="Menu" type="Control" parent="."]
visible = false
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="StartButton" type="Button" parent="Menu"]
layout_mode = 1
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -465.0
offset_top = -156.0
offset_right = -65.0
offset_bottom = -56.0
grow_horizontal = 0
grow_vertical = 0
theme = SubResource("Theme_vc2yo")
text = " New game "

[node name="Background" type="Sprite2D" parent="Menu"]
show_behind_parent = true
position = Vector2(960, 540)
texture = ExtResource("2_da848")

[node name="Game" type="Node3D" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Game"]
environment = SubResource("Environment_jq3ql")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Game/WorldEnvironment"]
transform = Transform3D(1, 0, 0, 0, 0.688355, 0.725374, 0, -0.725374, 0.688355, 0, 2524.93, 2439.16)

[node name="Player" parent="Game" instance=ExtResource("2_va6rj")]
transform = Transform3D(-3.49691e-08, 0, 0.8, 0, 0.8, 0, -0.8, 0, -3.49691e-08, 14, 0, 8)

[node name="Navigation" type="NavigationRegion3D" parent="Game"]
navigation_mesh = SubResource("NavigationMesh_24vrx")

[node name="Dungeon" parent="Game/Navigation" instance=ExtResource("1_bidkp")]

[node name="SpawnPoint" type="Node3D" parent="Game/Navigation/Dungeon"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -40.371, 0, -40.3611)
script = ExtResource("5_cpwk4")

[node name="SpawnTimer" type="Timer" parent="Game/Navigation/Dungeon/SpawnPoint"]

[node name="Portal" parent="Game/Navigation/Dungeon" instance=ExtResource("6_fj7u7")]
transform = Transform3D(0.707107, 0, -0.707107, 0, 1, 0, 0.707107, 0, 0.707107, -39.3878, -1.27369, -39.664)

[node name="SuccessScreen" type="Control" parent="."]
visible = false
layout_mode = 3
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -960.0
offset_top = -540.0
offset_right = 960.0
offset_bottom = 540.0
grow_horizontal = 2
grow_vertical = 2

[node name="WinImage" type="Sprite2D" parent="SuccessScreen"]
position = Vector2(1000, 536)
scale = Vector2(0.853333, 0.853333)
texture = ExtResource("7_rjwll")

[connection signal="game_started" from="." to="Game/Player" method="_on_main_game_started"]
[connection signal="game_started" from="." to="Game/Navigation/Dungeon/SpawnPoint" method="_on_main_game_started"]
[connection signal="pressed" from="Menu/StartButton" to="." method="_on_start_button_pressed"]
[connection signal="on_portal_destroyed" from="Game/Player" to="Game/Navigation/Dungeon/SpawnPoint" method="_on_player_on_portal_destroyed"]
